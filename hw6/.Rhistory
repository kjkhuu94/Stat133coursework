scale_fill_manual("Blue","Yellow","Green","Pink","Red","Brown")
help("scale_fill_manual")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),pch=21,color="black")+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=c("Blue","Yellow","Green","Pink","Red","Brown"))
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),pch=21,color="black")+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),pch=21,color="black")+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.6)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 50000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
limits = c(500, max(GDP_Per_Capita))
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000)),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)+
coord_cartesian(xlim = c(-500, 5000))
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000)),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)+
coord_cartesian(xlim = c(-500, 5000))
joined_table2 <- filter(joined_table2, Year == 1880)#input$Selected_Year
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=1880)+#input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
output$plot <- renderPlot({
joined_table2 <- filter(joined_table2, Year == input$Selected_Year)
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
scale_fill_manual(values=c("Blue","Yellow","Green","Pink","Red","Brown")))
joined_table2 <- filter(joined_table2, Year == input$Selected_Year)
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
joined_table2 <- filter(joined_table2, Year == input$Selected_Year)
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(joined_table2) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
library(rsconnect)
rsconnect::setAccountInfo(name='kjkhuu', token='7026F637349A913D4764773B6C860378', secret='4rI+F5U+s7ab41gy/Zu7LJb+41FVp+IiHqIAUDcr')
setwd("~/Stat133/Stat133coursework/hw6/Hw6_Test")
library(ggplot2)
library(ggvis)
library(dplyr)
library(rvest)
library(stringr)
library(tidyr)
library(scales)
Region_page="https://docs.google.com/spreadsheets/d/1OxmGUNWeADbPJkQxVPupSOK5MbAECdqThnvyPrwG5Os/pub?gid=1#)"
Region_xpath='//*[@class="waffle"]'
Region_codes <-Region_page %>%
read_html() %>%
html_nodes(xpath=Region_xpath) %>%
.[2] %>%
html_table(fill=TRUE) %>%
as.data.frame() %>%
select(2,3) %>%
slice(-1)
names(Region_codes)<- (c("country","Region"))
lifeexpectancy<-read.csv("lifeexpectancy.csv") %>%
gather(Year,Life_Expectancy,2:217) %>%
mutate(Year=str_extract_all(Year,"[0-9]{4}")) %>%
mutate(Year=as.integer(Year))
names(lifeexpectancy)<- c("country","Year","Life_Expectancy")
gdp<-read.csv("gdppc.csv") %>%
gather(Year,GDP,2:217) %>%
mutate(Year=str_extract_all(Year,"[0-9]{4}")) %>%
mutate(Year=as.integer(Year)) %>%
arrange(Year)
names(gdp)<-c("country","Year","GDP_Per_Capita")
population<-read.csv("population.csv") %>%
select(c(1:82)) %>%
gather(Year,Population, 2:82) %>%
mutate(Year=str_extract_all(Year,"[0-9]{4}")) %>%
mutate(Year=as.integer(Year)) %>%
filter(!is.na(Total.population))
names(population) <- c("country","Year","Population")
missing<- setdiff(1800:2015,unique(population$Year))
missing_df<- lapply(missing, function(x){
data.frame(country=unique(population$country), Year= rep(x, times=275), Population=NA)
})
missing_df<- do.call(rbind,missing_df)
final_pop<-rbind(population,missing_df) %>%
arrange(Year) %>%
mutate(decade=(Year%/%10)*10) %>%
group_by(country,decade) %>%
mutate(Population=ifelse(is.na(Population) & !all(is.na(Population)), mean(Population,na.rm=TRUE),
Population))
Region_gdp<- inner_join(gdp,Region_codes)
Region_lifeexpectancy<- inner_join(lifeexpectancy,Region_codes)
Region_population<- inner_join(final_pop,Region_codes)
joined_table<- full_join(Region_lifeexpectancy,Region_gdp)
joined_table2<-left_join(Region_population,joined_table)
write.csv(joined_table2,"cleaned_demographics.csv")
library(ggplot2)
library(ggvis)
library(dplyr)
library(rvest)
library(stringr)
library(tidyr)
library(scales)
library(shiny)
setwd("~/Stat133/Stat133coursework/hw6")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
final_df <- filter(final_df, input$Year)
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(final_df) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
final_df <- filter(final_df, input$Year)
cbPalette <- c("#E69F00", "#56B4E9", "#66CC99", "#F0E442", "#D55E00","#CC79A7")
ggplot(final_df) +
geom_point(aes(x = GDP_Per_Capita,y = Life_Expectancy,fill=Region,size=Population),
pch=21,color="black",
alpha=0.8)+
guides(size=FALSE)+
scale_x_log10(labels=dollar_format(prefix="$"),
limits = c(500, 70000),
breaks =c(500,5000,50000))+
scale_y_continuous(breaks=seq(25,75,25),
limits=c(20,80),
labels=c("25 Years","50 Years","75 Years"))+
labs(x="GDP Per Capita(Inflation-Adjusted)",
y="Life Expectancy at Birth",
title=input$Selected_Year)
theme(plot.title=element_text(size=20),
axis.title.y=element_text(size=15),
axis.title.x=element_text(size=15))+
scale_size_area(max_size = 25)+
scale_fill_manual(values=cbPalette)
final_df<- read.csv("cleaned_demographics.csv")
runApp("Hw6_Test")
runApp("Hw6_Test")
setwd("~/Stat133/stat133-su2016")
setwd("~/Stat133/stat133-su2016/20-lesson/examples/003-reactivity")
runApp("Hw6_Test")
runApp("004-mpg")
setwd("~/Stat133/stat133-su2016/20-lesson/examples")
runApp("004-mpg")
runApp("004-mpg")
setwd("~/Stat133/Stat133coursework/hw6/Hw6_Test")
runApp("004-mpg")
runApp("Hw6_Test")
setwd("~/Stat133/Stat133coursework/hw6")
runApp("Hw6_Test")
final_df<- read.csv("cleaned_demographics.csv")
setwd("~/Stat133/Stat133coursework/hw6/Hw6_Test")
final_df<- read.csv("cleaned_demographics.csv")
View(final_df)
final_df<- read.csv("cleaned_demographics.csv") %>%
select(-X)
View(final_df)
runApp("Hw6_Test")
setwd("~/Stat133/Stat133coursework/hw6")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
help("pch")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
runApp("Hw6_Test")
library(rsconnect)
rsconnect::setAccountInfo(name='kjkhuu',
token='7026F637349A913D4764773B6C860378',
secret='<SECRET>')
library(rsconnect)
rsconnect::deployApp('Stat133/Stat133coursework/hw6/Hw6_Test')
rsconnect::deployApp('~/Stat133/Stat133coursework/hw6/Hw6_Test')
setwd("~/Stat133/stat133-su2016/20-lesson/examples")
help("animationOptions")
setwd("~/Stat133/Stat133coursework/hw6/Hw6_Test")
setwd("~/Stat133/Stat133coursework/hw6")
runApp("Hw6_Test")
runApp("Hw6_Test")
rsconnect::deployApp('~/Stat133/Stat133coursework/hw6/Hw6_Test')
help("ggvis")
setwd("~/Stat133/Stat133coursework/hw6")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
help("add_axis")
runApp("Hw6_ggvis")
help("ggvis")
runApp("Hw6_ggvis")
help(paste0)
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
help("scale_nominal")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
help("scale_numeric")
help("layer_points")
help("paste0")
help("add_axis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
runApp("Hw6_ggvis")
help("input_slider")
runApp("Hw6_ggvis")
rsconnect::deployApp(~/Stat133/Stat133Coursework/hw6/HW6_ggvis)
rsconnect::deployApp(~/Stat133/Stat133Coursework/hw6/HW6_ggvis)
rsconnect::deployApp(~Stat133/Stat133Coursework/hw6/HW6_ggvis)
rsconnect::deployApp(Stat133/Stat133Coursework/hw6/HW6_ggvis)
rsconnect::deployApp(~/Stat133/Stat133Coursework/hw6/HW6_ggvis)
rsconnect::deployApp('~/Stat133/Stat133Coursework/hw6/HW6_ggvis')
rsconnect::deployApp('~/Stat133/Stat133Coursework/hw6/HW6_ggvis')
library(ggvis)
library(shiny)
library(dplyr)
library(tidyr)
runApp("hw6_ggvis")
runApp("hw6_ggvis")
runApp("Hw6_Test")
runApp("hw6_ggvis")
rsconnect::deployApp('~/Stat133/Stat133Coursework/hw6/HW6_ggvis')
help("ggvisOutput")
runApp("hw6_ggvis")
runApp("hw6_ggvis")
rsconnect::deployApp('~/Stat133/Stat133Coursework/hw6/HW6_ggvis')
rsconnect::deployApp('~/Stat133/Stat133Coursework/hw6/HW6_ggvis')
